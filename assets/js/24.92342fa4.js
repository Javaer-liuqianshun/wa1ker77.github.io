(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{207:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"å¯¹è±¡çš„å…±äº«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡çš„å…±äº«","aria-hidden":"true"}},[t._v("#")]),t._v(" å¯¹è±¡çš„å…±äº«")]),t._v(" "),s("p",[t._v("è¦ç¼–å†™æ­£ç¡®çš„å¹¶å‘ç¨‹åºï¼Œå…³é”®é—®é¢˜åœ¨äºï¼šåœ¨è®¿é—®å…±äº«çš„å¯å˜çŠ¶æ€æ—¶éœ€è¦è¿›è¡Œæ­£ç¡®çš„ç®¡ç†ã€‚åœ¨çº¿ç¨‹å®‰å…¨æ€§ä¸­ä»‹ç»äº†å¦‚ä½•é€šè¿‡åŒæ­¥æ¥é¿å…å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è®¿é—®ç›¸åŒçš„æ•°æ®ï¼Œè€Œå¯¹è±¡çš„å…±äº«ä»‹ç»å¦‚ä½•å…±äº«å’Œå‘å¸ƒå¯¹è±¡ï¼Œä»è€Œä½¿å®ƒä»¬èƒ½å¤Ÿå®‰å…¨åœ°ç”±å¤šä¸ªçº¿åŒæ—¶è®¿é—®ã€‚")]),t._v(" "),s("h2",{attrs:{id:"å¯è§æ€§å’Œæœ‰åºæ€§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯è§æ€§å’Œæœ‰åºæ€§","aria-hidden":"true"}},[t._v("#")]),t._v(" å¯è§æ€§å’Œæœ‰åºæ€§")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NoVisibility")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" ready"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReaderThread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("ready"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                Thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yield")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReaderThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        number "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ready "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("å¯è§æ€§")]),t._v("ï¼šNoVisibilityå¯èƒ½ä¼šæŒç»­å¾ªç¯ä¸‹å»ï¼Œå› ä¸ºReaderThreadçº¿ç¨‹å¯èƒ½æ°¸è¿œéƒ½çœ‹ä¸åˆ°"),s("code",[t._v("ready = true")]),t._v("çš„æƒ…å†µã€‚åŸå› æ˜¯ä¸»çº¿ç¨‹æ‰§è¡Œ"),s("code",[t._v("ready = true")]),t._v("åå¯èƒ½æ²¡æœ‰å†™å…¥ä¸»å­˜ï¼Œæ‰€ä»¥ReaderThreadçº¿ç¨‹çœ‹åˆ°readyä¸€ç›´ä¸ºåˆå§‹å€¼falseã€‚")]),t._v(" "),s("p",[s("strong",[t._v("æœ‰åºæ€§")]),t._v("ï¼šåœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ã€å¤„ç†å™¨ä»¥åŠè¿è¡Œæ—¶ç­‰éƒ½å¯èƒ½å¯¹æ“ä½œçš„æ‰§è¡Œé¡ºåºè¿›è¡Œä¸€äº›æ„æƒ³ä¸åˆ°çš„è°ƒæ•´ï¼Œä¿—ç§°â€œ"),s("strong",[t._v("é‡æ’åº")]),t._v("â€ã€‚åœ¨å•çº¿ç¨‹ä¸‹â€œé‡æ’åºâ€å¯¹çº¿ç¨‹å®‰å…¨æ€§æ²¡æœ‰å½±å“ï¼Œåœ¨å¤šçº¿ç¨‹ç”±äºâ€œé‡æ’åºâ€æ— æ³•å¾—åˆ°æ­£ç¡®çš„ç»“è®ºã€‚NoVisibilityå¯èƒ½ä¼šè¾“å‡º0ï¼Œå› ä¸ºâ€œé‡æ’åºâ€ä¸»çº¿ç¨‹æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯"),s("code",[t._v("ready = true; number = 42;")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("é¿å…è¿™äº›é—®é¢˜æ–¹å¼ï¼š"),s("strong",[t._v("åªè¦æœ‰æ•°æ®åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œå°±ä½¿ç”¨æ­£ç¡®çš„åŒæ­¥")]),t._v("ã€‚")]),t._v(" "),s("h3",{attrs:{id:"åŠ é”ä¸å¯è§æ€§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŠ é”ä¸å¯è§æ€§","aria-hidden":"true"}},[t._v("#")]),t._v(" åŠ é”ä¸å¯è§æ€§")]),t._v(" "),s("p",[t._v("åœ¨è®¿é—®æŸä¸ªå…±äº«ä¸”å¯å˜çš„å˜é‡æ—¶è¦æ±‚"),s("strong",[t._v("æ‰€æœ‰çº¿ç¨‹åœ¨åŒä¸€é”ä¸ŠåŒæ­¥")]),t._v("ï¼Œå°±æ˜¯ä¸ºäº†ç¡®ä¿æŸä¸ªçº¿ç¨‹å†™å…¥è¯¥å˜é‡çš„å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´éƒ½æ˜¯å¯è§çš„ã€‚")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("åŠ é”çš„å«ä¹‰ä¸ä»…ä»…å±€é™äºäº’æ–¥è¡Œä¸ºï¼Œè¿˜åŒ…æ‹¬å†…å­˜å¯è§æ€§ã€‚ä¸ºäº†ç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½èƒ½çœ‹åˆ°å…±äº«å˜é‡çš„æœ€æ–°å€¼ï¼Œæ‰€æœ‰æ‰§è¡Œè¯»æ“ä½œæˆ–è€…å†™æ“ä½œçš„çº¿ç¨‹éƒ½å¿…é¡»åœ¨éƒ½"),s("strong",[t._v("åŒä¸€ä¸ªé”ä¸ŠåŒæ­¥")]),t._v("ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"volatileå˜é‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#volatileå˜é‡","aria-hidden":"true"}},[t._v("#")]),t._v(" volatileå˜é‡")]),t._v(" "),s("p",[t._v("å½“æŠŠå˜é‡å£°æ˜ä¸ºvolatileç±»å‹åï¼Œç¼–è¯‘å™¨ä¸è¿è¡Œæ—¶éƒ½ä¼šæ³¨æ„åˆ°è¿™ä¸ªå˜é‡æ˜¯å…±äº«çš„ï¼Œå› æ­¤ä¸ä¼šå°†è¯¥å˜é‡ä¸Šçš„æ“ä½œä¸å…¶ä»–å†…å­˜æ“ä½œä¸€èµ·é‡æ’åº("),s("strong",[t._v("æœ‰åºæ€§ï¼Œæ˜¯é€šè¿‡å†…å­˜å±éšœå®ç°çš„")]),t._v(")ã€‚volatileå˜é‡ä¸ä¼šè¢«ç¼“å­˜åœ¨å¯„å­˜å™¨æˆ–è€…å…¶ä»–å¤„ç†å™¨ä¸å¯è§çš„åœ°æ–¹ï¼Œå› æ­¤åœ¨è¯»å–volatileç±»å‹çš„å˜é‡æ—¶æ€»ä¼šè¿”å›æœ€æ–°å†™å…¥çš„å€¼("),s("strong",[t._v("å¯è§æ€§ï¼Œæ˜¯é€šè¿‡åŒä¸€ä¸ªé”å®ç°çš„")]),t._v(")ã€‚")]),t._v(" "),s("br"),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ’¡ ç»¼ä¸Šï¼šåŠ é”æœºåˆ¶æ—¢å¯ä»¥ç¡®ä¿åŸå­æ€§åˆå¯ä»¥ç¡®ä¿å¯è§æ€§è¿˜å¯ä»¥ç¡®ä¿æœ‰åºæ€§ï¼Œè€Œvolatileå˜é‡åªèƒ½ç¡®ä¿å¯è§æ€§å’Œæœ‰åºæ€§ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"çº¿ç¨‹å°é—­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹å°é—­","aria-hidden":"true"}},[t._v("#")]),t._v(" çº¿ç¨‹å°é—­")]),t._v(" "),s("p",[t._v("è®¿é—®å…±äº«çš„ã€å¯å˜çš„æ•°æ®è¦æ±‚ä½¿ç”¨åŒæ­¥ã€‚ä¸€ä¸ªå¯ä»¥é¿å…åŒæ­¥çš„æ–¹å¼å°±æ˜¯ä¸å…±äº«æ•°æ®ã€‚å¦‚æœæ•°æ®ä»…åœ¨å•çº¿ç¨‹ä¸­è¢«è®¿é—®ï¼Œå°±ä¸éœ€è¦ä»»ä½•åŒæ­¥ã€‚çº¿ç¨‹å°é—­æŠ€æœ¯æ˜¯å®ç°çº¿ç¨‹å®‰å…¨æœ€ç®€å•çš„æ–¹å¼ä¹‹ä¸€ã€‚å½“å¯¹è±¡å°é—­åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ—¶ï¼Œè¿™ç§åšæ³•ä¼šè‡ªåŠ¨æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ã€‚")]),t._v(" "),s("p",[t._v("çº¿ç¨‹å°é—­å®ç°æ–¹æ³•:")]),t._v(" "),s("ol",[s("li",[t._v("Ad-hocï¼šç¨‹åºä¸­æ§åˆ¶å®ç°ï¼Œä¸æ¨è")]),t._v(" "),s("li",[t._v("æ ˆå°é—­ï¼šå±€éƒ¨å˜é‡(æ–¹æ³•ä¸­å®šä¹‰çš„å˜é‡)ï¼Œæ— å¹¶å‘é—®é¢˜")]),t._v(" "),s("li",[t._v("ThreadLocalï¼šç‰¹åˆ«å¥½çš„å°é—­çš„æ–¹æ³•")])]),t._v(" "),s("h2",{attrs:{id:"ä¸å˜æ€§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸å˜æ€§","aria-hidden":"true"}},[t._v("#")]),t._v(" ä¸å˜æ€§")]),t._v(" "),s("p",[t._v("å¦‚æœæŸä¸ªå¯¹è±¡åœ¨è¢«åˆ›å»ºä»¥åå…¶çŠ¶æ€å°±ä¸èƒ½è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ç§°ä¸ºä¸å¯å˜å¯¹è±¡ã€‚"),s("strong",[t._v("çº¿ç¨‹å®‰å…¨æ€§æ˜¯ä¸å¯å˜å¯¹è±¡çš„å›ºæœ‰å±æ€§ä¹‹ä¸€ï¼Œå®ƒä»¬çš„ä¸å˜æ€§æ¡ä»¶æ˜¯ç”±æ„é€ å™¨å‡½æ•°åˆ›å»ºçš„")]),t._v("ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("ä¸å¯å˜å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚")])]),t._v(" "),s("p",[t._v("Javaè¯­è¨€è§„èŒƒå’ŒJavaå†…å­˜æ¨¡å‹ä¸­éƒ½æ²¡æœ‰ç»™å‡ºä¸å¯å˜æ€§çš„æ­£å¼å®šä¹‰ï¼Œä½†ä¸å¯å˜æ€§å¹¶ä¸ç­‰äºå°†å¯¹è±¡ä¸­æ‰€æœ‰çš„åŸŸéƒ½å£°æ˜ä¸ºfinalç±»å‹ï¼Œå³ä½¿å¯¹è±¡ä¸­æ‰€æœ‰çš„åŸŸéƒ½æ˜¯finalç±»å‹çš„ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿä»ç„¶æ˜¯å¯å˜çš„ï¼Œ"),s("strong",[t._v("å› ä¸ºåœ¨finalç±»å‹ä¸­çš„åŸŸå¯ä»¥ä¿å­˜å¯¹å¯å˜å¯¹è±¡çš„å¼•ç”¨")]),t._v("ã€‚")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("å¯¹è±¡ä¸å¯å˜æ¡ä»¶")]),t._v(" "),s("p",[t._v("å½“æ»¡è¶³ "),s("code",[t._v("1.å¯¹è±¡åˆ›å»ºä»¥åå…¶çŠ¶æ€å°±ä¸èƒ½ï¼›2. å¯¹è±¡çš„æ‰€æœ‰åŸŸéƒ½æ˜¯finalç±»å‹ï¼›3. å¯¹è±¡æ˜¯æ­£ç¡®åˆ›å»ºçš„(åœ¨å¯¹è±¡çš„åˆ›å»ºæœŸé—´ï¼Œthiså¼•ç”¨æ²¡æœ‰é€¸å‡º)")]),t._v("ï¼Œå¯¹è±¡æ‰æ˜¯ä¸å¯å˜çš„ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"ä½¿ç”¨volatileç±»å‹æ¥å‘å¸ƒä¸å¯å˜å¯¹è±¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨volatileç±»å‹æ¥å‘å¸ƒä¸å¯å˜å¯¹è±¡","aria-hidden":"true"}},[t._v("#")]),t._v(" ä½¿ç”¨volatileç±»å‹æ¥å‘å¸ƒä¸å¯å˜å¯¹è±¡")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * ä¸å¯å˜å¯¹è±¡\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Immutable")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OneValueCache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" BigInteger lastNumer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" BigInteger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" lastFactors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("OneValueCacle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BigInteger i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("BigInteger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" factors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        lastNumber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        lastFactors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" factors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" BigInteger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFactors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BigInteger i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastNumer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" null "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("lastNumer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            retrun null"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Arrays"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("copyOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastFactors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lastFactors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ThreadSafe")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VolatileCacheFactorizer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Servlet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" OneValueCache cache "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OneValueCache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("null"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("null"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ServletRequest req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ServletResponse resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        BigInteger i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("extractFromRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        BigInteger factors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFactors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("factors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" null"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            factors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("factor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            cache "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OneValueCache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("factors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeIntoResponse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("factors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("åœ¨è®¿é—®å’Œæ›´æ–°å¤šä¸ªç›¸å…³å˜é‡æ—¶å‡ºç°çš„ç«äº‰æ¡ä»¶é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡å°†è¿™äº›å˜é‡å…¨éƒ¨ä¿å­˜åœ¨ä¸€ä¸ªä¸å¯å˜å¯¹è±¡ä¸­æ¥æ¶ˆé™¤ã€‚å½“çº¿ç¨‹è·å¾—äº†å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨åï¼Œå°±ä¸å¿…æ‹…å¿ƒå¦ä¸€ä¸ªçº¿ç¨‹ä¼šä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ã€‚å¦‚æœè¦æ›´æ–°è¿™äº›å˜é‡ï¼Œé‚£ä¹ˆå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¯¹è±¡ï¼Œä½†å…¶ä»–ä½¿ç”¨åŸæœ‰å¯¹è±¡çš„çº¿ç¨‹ä»ç„¶ä¼šçœ‹åˆ°å¯¹è±¡å¤„äºä¸€è‡´çš„çŠ¶æ€ã€‚")]),t._v(" "),s("p",[t._v("VolatileCacheFactorizerä½¿ç”¨äº†OneValueCacheæ¥ä¿å­˜ç¼“å­˜çš„æ•°å€¼åŠå…¶å› æ•°ã€‚å½“ä¸€ä¸ªçº¿ç¨‹å°†volatileç±»å‹çš„cacheè®¾ç½®ä¸ºå¼•ç”¨ä¸€ä¸ªæ–°çš„OneValueCacheæ—¶ï¼Œå…¶ä»–çº¿ç¨‹å°±ä¼šç«‹å³çœ‹åˆ°æ–°ç¼“å­˜çš„æ•°æ®ã€‚ä¸cacheç›¸å…³çš„æ“ä½œæ—¶ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œå› ä¸ºOneValueCacheæ˜¯ä¸å¯å˜çš„ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("é€šè¿‡ä½¿ç”¨åŒ…å«å¤šä¸ªçŠ¶æ€å˜é‡çš„å®¹å™¨å¯¹è±¡æ¥ç»´æŒä¸å˜æ€§æ¡ä»¶ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªvolatileç±»å‹çš„å¼•ç”¨æ¥ç¡®ä¿å¯è§æ€§ï¼Œä½¿å¾—VolatileCacheFactorizeråœ¨æ²¡æœ‰æ˜¾ç¤ºåœ°ä½¿ç”¨é”çš„æƒ…å†µä¸‹ä»ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„")]),t._v("ã€‚")])])}],!1,null,null,null);e.options.__file="sharing-objects.md";a.default=e.exports}}]);